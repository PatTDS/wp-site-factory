# Export WordPress Theme

Generate a production-ready WordPress theme from WPF patterns and blueprint data.

## Usage

When the user requests:
- "Export WordPress theme"
- "Generate theme files"
- "Create installable theme"
- "Build production theme"

## Process

### 1. Gather Theme Information

Prompt user for:
- **Theme Name:** Display name (e.g., "Construction Pro")
- **Theme Slug:** URL-safe identifier (e.g., "construction-pro")
- **Author:** Developer/agency name
- **Description:** Brief theme description
- **Version:** Starting version (default: 1.0.0)

**Or extract from blueprint:**
```json
{
  "company": {
    "name": "ACME Construction",
    "slug": "acme-construction"
  }
}
```

### 2. Create Theme Directory Structure

Generate WordPress theme structure:

```
output/theme/{theme-slug}/
├── style.css                    # Theme header
├── functions.php                # Theme setup
├── index.php                    # Main template
├── header.php                   # Header template
├── footer.php                   # Footer template
├── screenshot.png               # Theme screenshot (1200x900)
├── assets/
│   ├── css/
│   │   └── tailwind.css        # Compiled Tailwind CSS
│   ├── js/
│   │   └── main.js             # Theme JavaScript
│   └── images/
│       └── logo.png
├── inc/
│   ├── block-patterns.php      # Pattern registration
│   └── theme-customizer.php    # Customizer options
├── patterns/
│   ├── hero.php
│   ├── services.php
│   ├── about.php
│   ├── contact.php
│   ├── testimonials.php
│   ├── header.php
│   └── footer.php
├── templates/
│   ├── page-home.php           # Homepage template
│   └── page-contact.php        # Contact page template
└── theme.json                  # Block editor configuration
```

### 3. Generate style.css

Create WordPress theme header:

```css
/*
Theme Name: {theme-name}
Theme URI: https://wpf.example.com/themes/{theme-slug}
Author: {author}
Author URI: {author-uri}
Description: {description}
Version: {version}
Requires at least: 6.0
Tested up to: 6.7
Requires PHP: 8.0
License: GPL-2.0-or-later
License URI: https://www.gnu.org/licenses/gpl-2.0.html
Text Domain: {theme-slug}
Tags: block-patterns, block-styles, custom-colors, custom-logo, editor-style, full-site-editing, one-column, responsive-layout, rtl-language-support, threaded-comments, translation-ready
*/

/* Tailwind CSS output */
@import url('./assets/css/tailwind.css');

/* Theme-specific overrides */
:root {
  --font-heading: 'DM Sans', sans-serif;
  --font-body: 'Source Sans 3', sans-serif;
  --color-primary: #0284c7;
  --color-secondary: #dc2626;
}
```

### 4. Generate functions.php

Create theme setup file:

```php
<?php
/**
 * Theme Functions
 * Generated by WPF Orchestrator
 *
 * @package {theme-slug}
 * @version {version}
 */

if (!defined('ABSPATH')) {
    exit; // Exit if accessed directly
}

/**
 * Theme Setup
 */
function {theme_slug_underscores}_setup() {
    // Text domain
    load_theme_textdomain('{theme-slug}', get_template_directory() . '/languages');

    // Theme support
    add_theme_support('title-tag');
    add_theme_support('post-thumbnails');
    add_theme_support('html5', [
        'search-form',
        'comment-form',
        'comment-list',
        'gallery',
        'caption',
        'style',
        'script',
    ]);
    add_theme_support('editor-styles');
    add_theme_support('wp-block-styles');
    add_theme_support('responsive-embeds');
    add_theme_support('custom-logo', [
        'height'      => 100,
        'width'       => 400,
        'flex-height' => true,
        'flex-width'  => true,
    ]);

    // Navigation menus
    register_nav_menus([
        'primary' => esc_html__('Primary Menu', '{theme-slug}'),
        'footer'  => esc_html__('Footer Menu', '{theme-slug}'),
    ]);
}
add_action('after_setup_theme', '{theme_slug_underscores}_setup');

/**
 * Enqueue Styles and Scripts
 */
function {theme_slug_underscores}_scripts() {
    // Main stylesheet
    wp_enqueue_style(
        '{theme-slug}-style',
        get_stylesheet_uri(),
        [],
        '{version}'
    );

    // Tailwind CSS
    wp_enqueue_style(
        '{theme-slug}-tailwind',
        get_template_directory_uri() . '/assets/css/tailwind.css',
        [],
        '{version}'
    );

    // Main JavaScript
    wp_enqueue_script(
        '{theme-slug}-main',
        get_template_directory_uri() . '/assets/js/main.js',
        [],
        '{version}',
        true
    );

    // Font loading
    wp_enqueue_style(
        '{theme-slug}-fonts',
        'https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600;700&family=Source+Sans+3:wght@400;600&display=swap',
        [],
        null
    );
}
add_action('wp_enqueue_scripts', '{theme_slug_underscores}_scripts');

/**
 * Register Block Patterns
 */
require get_template_directory() . '/inc/block-patterns.php';

/**
 * Theme Customizer
 */
require get_template_directory() . '/inc/theme-customizer.php';
```

### 5. Generate inc/block-patterns.php

Register all patterns:

```php
<?php
/**
 * Block Pattern Registration
 *
 * @package {theme-slug}
 */

if (!defined('ABSPATH')) {
    exit;
}

/**
 * Register Pattern Category
 */
function {theme_slug_underscores}_register_pattern_categories() {
    register_block_pattern_category('{theme-slug}', [
        'label' => esc_html__('Theme Patterns', '{theme-slug}'),
    ]);
}
add_action('init', '{theme_slug_underscores}_register_pattern_categories');

/**
 * Register Block Patterns
 */
function {theme_slug_underscores}_register_block_patterns() {
    $patterns = [
        'hero',
        'services',
        'about',
        'contact',
        'testimonials',
        'header',
        'footer',
    ];

    foreach ($patterns as $pattern) {
        $pattern_file = get_template_directory() . "/patterns/{$pattern}.php";
        if (file_exists($pattern_file)) {
            require_once $pattern_file;
        }
    }
}
add_action('init', '{theme_slug_underscores}_register_block_patterns');
```

### 6. Convert Patterns to PHP

For each pattern HTML file, create PHP registration:

```php
<?php
/**
 * Pattern: Hero Section
 *
 * @package {theme-slug}
 */

register_block_pattern(
    '{theme-slug}/hero',
    [
        'title'       => esc_html__('Hero Section', '{theme-slug}'),
        'description' => esc_html__('Full-width hero with headline and CTA', '{theme-slug}'),
        'categories'  => ['{theme-slag}', 'hero'],
        'keywords'    => ['hero', 'banner', 'header'],
        'content'     => '
            <!-- wp:group {"className":"hero-section bg-primary-50"} -->
            <section class="hero-section bg-primary-50 py-24 lg:py-32">
                <div class="max-w-7xl mx-auto px-4">
                    <!-- Pattern HTML here -->
                </div>
            </section>
            <!-- /wp:group -->
        ',
    ]
);
```

### 7. Generate theme.json

Create block editor configuration:

```json
{
  "$schema": "https://schemas.wp.org/trunk/theme.json",
  "version": 2,
  "settings": {
    "color": {
      "palette": [
        {
          "slug": "primary",
          "color": "#0284c7",
          "name": "Primary"
        },
        {
          "slug": "secondary",
          "color": "#dc2626",
          "name": "Secondary"
        },
        {
          "slug": "success",
          "color": "#16a34a",
          "name": "Success"
        },
        {
          "slug": "warning",
          "color": "#f59e0b",
          "name": "Warning"
        },
        {
          "slug": "danger",
          "color": "#dc2626",
          "name": "Danger"
        }
      ]
    },
    "typography": {
      "fontFamilies": [
        {
          "fontFamily": "'DM Sans', sans-serif",
          "slug": "heading",
          "name": "Heading Font"
        },
        {
          "fontFamily": "'Source Sans 3', sans-serif",
          "slug": "body",
          "name": "Body Font"
        }
      ],
      "fontSizes": [
        {
          "slug": "small",
          "size": "0.875rem",
          "name": "Small"
        },
        {
          "slug": "medium",
          "size": "1rem",
          "name": "Medium"
        },
        {
          "slug": "large",
          "size": "1.25rem",
          "name": "Large"
        },
        {
          "slug": "x-large",
          "size": "1.5rem",
          "name": "Extra Large"
        }
      ]
    },
    "spacing": {
      "spacingSizes": [
        {
          "slug": "small",
          "size": "1rem",
          "name": "Small"
        },
        {
          "slug": "medium",
          "size": "1.5rem",
          "name": "Medium"
        },
        {
          "slug": "large",
          "size": "2rem",
          "name": "Large"
        }
      ]
    }
  },
  "styles": {
    "typography": {
      "fontFamily": "var(--wp--preset--font-family--body)"
    },
    "elements": {
      "h1": {
        "typography": {
          "fontFamily": "var(--wp--preset--font-family--heading)",
          "fontSize": "3rem",
          "fontWeight": "700"
        }
      },
      "h2": {
        "typography": {
          "fontFamily": "var(--wp--preset--font-family--heading)",
          "fontSize": "2.25rem",
          "fontWeight": "700"
        }
      }
    }
  }
}
```

### 8. Build Tailwind CSS

Compile Tailwind CSS for production:

```bash
# Create tailwind.config.js
cat > output/theme/{theme-slug}/tailwind.config.js << 'EOF'
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    './**/*.php',
    './**/*.html',
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#f0f9ff',
          600: '#0284c7',
          700: '#0369a1',
        },
      },
      fontFamily: {
        heading: ['DM Sans', 'sans-serif'],
        body: ['Source Sans 3', 'sans-serif'],
      },
    },
  },
  plugins: [],
}
EOF

# Build CSS
cd output/theme/{theme-slug}
npx tailwindcss -i ./assets/css/tailwind.src.css -o ./assets/css/tailwind.css --minify
```

### 9. Generate Screenshot

Create theme screenshot (1200x900):

```bash
# Use Playwright to capture homepage preview
npm run generate-screenshot -- --theme={theme-slug} --output=screenshot.png
```

### 10. Create README.txt

Generate WordPress readme:

```
=== {theme-name} ===

Contributors: {author-slug}
Requires at least: 6.0
Tested up to: 6.7
Requires PHP: 8.0
License: GPLv2 or later
License URI: https://www.gnu.org/licenses/gpl-2.0.html

== Description ==

{description}

== Installation ==

1. Upload the theme folder to /wp-content/themes/
2. Activate the theme through 'Appearance > Themes' in WordPress
3. Customize via Appearance > Customize

== Features ==

* Responsive design
* Block patterns
* Full Site Editing support
* Customizer options
* Accessibility ready

== Changelog ==

= {version} =
* Initial release

== Credits ==

* Generated by WPF Orchestrator
* Tailwind CSS: https://tailwindcss.com
* Fonts: Google Fonts
```

### 11. Package Theme

Create ZIP archive:

```bash
cd output/theme
zip -r {theme-slug}-{version}.zip {theme-slug}/ -x "*.git*" "node_modules/*" "*.log"
```

### 12. Run WordPress Theme Check

Validate theme meets WordPress standards:

```bash
# Install WP Theme Check plugin
wp plugin install theme-check --activate

# Run checks
wp theme check {theme-slug}
```

Fix any errors or warnings before finalizing.

### 13. Generate Installation Instructions

Create installation guide:

```markdown
# {theme-name} Installation

## Prerequisites

- WordPress 6.0+
- PHP 8.0+

## Installation Methods

### Via WordPress Admin

1. Download `{theme-slug}-{version}.zip`
2. Go to Appearance > Themes > Add New
3. Click "Upload Theme"
4. Select the ZIP file
5. Click "Install Now"
6. Activate the theme

### Via FTP

1. Extract `{theme-slug}-{version}.zip`
2. Upload the `{theme-slug}` folder to `/wp-content/themes/`
3. Go to Appearance > Themes
4. Activate the theme

### Via WP-CLI

```bash
wp theme install {theme-slug}-{version}.zip --activate
```

## Configuration

### Navigation Menus

1. Go to Appearance > Menus
2. Create a new menu
3. Assign to "Primary Menu" location
4. Add pages/links

### Customizer

Go to Appearance > Customize:

- **Site Identity:** Upload logo
- **Colors:** Customize primary/secondary colors
- **Typography:** Adjust font sizes
- **Homepage Settings:** Set static homepage

### Block Patterns

Available patterns:
- Hero Section
- Services Grid
- About Section
- Contact Form
- Testimonials
- Header
- Footer

Insert via Block Editor > Patterns > Theme Patterns

## Support

For issues or questions:
- Email: {support-email}
- Documentation: {docs-url}
```

## Output

Provide to user:

1. **Theme Directory:** `output/theme/{theme-slug}/`
2. **ZIP File:** `output/theme/{theme-slug}-{version}.zip`
3. **Installation Guide:** `output/theme/{theme-slug}/INSTALL.md`
4. **File Count:** Total files generated
5. **Theme Check Results:** Pass/fail status
6. **Next Steps:**
   - Install on WordPress site
   - Test all patterns
   - Customize colors/fonts
   - Deploy to production

## Validation Checklist

Before finalizing theme export:

- [ ] style.css has proper theme headers
- [ ] functions.php loads without errors
- [ ] All patterns registered correctly
- [ ] Tailwind CSS compiled and minified
- [ ] theme.json has correct block editor config
- [ ] Screenshot generated (1200x900)
- [ ] README.txt follows WordPress format
- [ ] Theme passes WordPress Theme Check
- [ ] Navigation menus registered
- [ ] No PHP errors or warnings
- [ ] All assets enqueued correctly
- [ ] Fonts loaded properly
- [ ] ZIP archive created successfully

## Tips

- Always test in fresh WordPress install
- Check PHP error logs after activation
- Verify patterns display correctly in editor
- Test responsive design on mobile
- Run accessibility checks (WAVE, axe)
- Check Lighthouse performance score
- Document customization options
- Include changelog in README
